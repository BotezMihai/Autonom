<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Home</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/home.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
        integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
</head>

<body class="base">
    <header class="base-container">
        <div class="logo"><img style="width:22em; height:auto;" src="../Photos/Logo.png" alt="Logo"></div>
        <div class="nav-placeholder">
            <section>
                <nav>
                    <ul>
                        <li>
                            <a href="../html/home.html" title="Home">Home</a>
                        </li>
                        <li>
                            <a href="" title="Tags" class="active">Tags</a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropbtn"><i class="far fa-user-circle fa-lg"></i> Anca Popa <i
                                    class="fas fa-caret-down"></i> </a>
                            <div class="dropdown-content">
                                <a href="../html/home.html"><i class="fas fa-thumbtack lg"></i> My Events</a>
                                <a href="#"><i class="fas fa-calendar-alt lg"></i> Export Calendar</a>
                                <a href="../html/LoginFinal.html"><i class="fas fa-sign-out-alt lg"></i> Logout</a>
                            </div>
                        </li>
                    </ul>
                </nav>
            </section>
        </div>
    </header>
    <main class="base-container">
        <h1>Tags</h1>
        <div class="actionbar"></div>
        <div class="tags">
            <!-- <div class="tag-card" id="card1" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Public Speaking</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Public Speaking</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card2" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Web Technologies</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Web Technologies</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card3" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Frontend</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Frontend</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card4" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Social</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Social</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card5" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Politics</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Politics</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card6" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Religion</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Religion</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card7" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Volunteering</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Volunteering</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card8" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>VR</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>VR</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card9" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Artifical Intelligence</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Artifical Intelligence</h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div>
            <div class="tag-card" id="card10" onclick="handleEvent(this.id)">
                <div class="tag-card-inner">
                    <div class="tag-card-front">
                        <h3>Chinese Community</h3>
                    </div>
                    <div class="tag-card-back">
                        <h3>Chinese Community </h3>
                        <span class="far fa-heart fa-2x"></span>
                    </div>
                </div>
            </div> -->
        </div>
    </main>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const url = "https://develop-dot-autonomus.appspot.com/" + "tags";
            const proxy = "https://cors-anywhere.herokuapp.com/";
            fetch(proxy + url, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + sessionStorage.getItem('token')
                }
            }).then((resp) => resp.json())
                .then((resp) => {
                    var parent = document.getElementsByClassName("tags")[0];
                    for (var indice = 0; indice < resp.length; indice++) {
                        var div = document.createElement("div");
                        div.classList += " tag-card";
                        div.dataset.id = resp[indice].id;
                        parent.appendChild(div);
                        var div2 = document.createElement('div');
                        div2.classList += " tag-card-inner";
                        div.appendChild(div2);
                        var div3 = document.createElement('div');
                        div3.classList += " tag-card-front";
                        div2.appendChild(div3);
                        var h3 = document.createElement("h3");
                        h3.innerHTML = resp[indice].name;
                        div3.appendChild(h3);
                        var div4 = document.createElement("div");
                        div2.appendChild(div4);
                        div4.classList += " tag-card-back";
                        h3 = document.createElement("h3");
                        h3.innerHTML = resp[indice].name;
                        div4.appendChild(h3);
                        var span = document.createElement('span');
                        span.classList += " far";
                        span.classList += " fa-heart";
                        span.classList += " fa-2x";
                        div4.appendChild(span);
                        if (resp[indice].selected == "true") {
                            handleEvent(div.dataset.id);
                        }
                        div.addEventListener('click', function (indice, event) {
                            var element = document.getElementsByClassName('tag-card')[indice];
                            var style = element.getElementsByClassName('tag-card-inner')[0].style;
                            var id = document.getElementsByClassName('tag-card')[indice].dataset.id;
                            var data = { "tag_id": id };
                            const url = "https://develop-dot-autonomus.appspot.com/" + "tags";
                            const proxy = "https://cors-anywhere.herokuapp.com/";
                            if (style.transform == "rotateY(180deg)") {
                                style.transform = "none";
                            }
                            else {
                                style.transform = "rotateY(180deg)";
                            }
                            if (style.transform == "none") {
                                fetch(proxy + url, {
                                    method: 'DELETE',
                                    body: JSON.stringify(data),
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'Authorization': 'Bearer ' + sessionStorage.getItem('token')
                                    }
                                }).then((resp) => resp.json())
                                    .then((resp) => {
                                        console.log(resp);

                                    });


                            } else {
                                fetch(proxy + url, {
                                    method: 'PUT',
                                    body: JSON.stringify(data),
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'Authorization': 'Bearer ' + sessionStorage.getItem('token')
                                    }
                                }).then((resp) => resp.json())
                                    .then((resp) => {
                                        console.log(resp);

                                    });
                            }


                        }.bind(event, indice));

                    }
                });


        });
    </script>
    <script>
        function handleEvent(id) {
            var element = document.querySelectorAll('[data-id~=' + id + ']');
            var style = element[0].getElementsByClassName('tag-card-inner')[0].style;
            if (style.transform == "rotateY(180deg)") {
                style.transform = "none";
            }
            else {
                style.transform = "rotateY(180deg)";
            }

        }
    </script>

</body>

</html>